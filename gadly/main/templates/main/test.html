<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>Document</title>
    <style>
        .input_area{
            width:47%;
            height:750px;
            border-style:solid;
            border-color:#000;
            float:left;
        }
        .edit_area{
            width:47%;
            height:750px;
            border-style:solid;
            border-color:#000;
            float:right;
        }
        .btn{
            clear:both
        }
        .highlight{
            color: tomato;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }

        /* Dropdown Content (Hidden by Default) */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f1f1f1;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

        /* Links inside the dropdown */
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        /* Change color of dropdown links on hover */
        .dropdown-content a:hover {background-color: #ddd;}

        /* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
        .show {display:block;}
    </style>
</head>
<body onload="docload()">
    <form action="/main/paraphrase/" method="POST">
        {% csrf_token %}
    <input type="hidden" name="input_text" id='input_field' value="{{ input_text }}">
    <div contenteditable="true" class="input_area" id="input" placeholder="Enter Your Phrase" required name="input_text">
        {{ input_text }}
    </div>
    <div contenteditable="true" class="edit_area" id="output" placeholder="Paraphrased Text" name="output_text">

    </div> 
    <button class="btn" onclick='submitform()' type='submit'>Submit</button>
    </form>

    <button class="btn" onclick='paraphrase()'>Paraphrase</button>

    <script type="text/javascript">
        var id_num = 1
        var data = ''
        var words = ''
        var filtered_list = ''
        let text = ''

        function docload(){
            data = JSON.parse("{{dataJSON|escapejs}}")
            words = data.words
            replacement = data.replacement_words
            console.log(data)
        }

        function submitform(){
            document.getElementById('input_field').value=document.getElementById('input').innerHTML
        }
        function paraphrase(){
            for (let word of words){
                if(replacement.includes(word)){
                        text += " <div class='dropdown'>"+
                        "<span class='highlight' type='button' data-toggle='dropdown' id="+id_num+" onClick='dropdown()'>" + word +
                        "</span>" +
                        "<ul class='dropdown-menu'>" +
                        "<li><a id = '1'>Word 1</a></li>"+
                        "<li><a id = '2'>Word 2</a></li>" +
                        "<li><a id = '3'>Word 3</a></li>" +
                        "</ul>" +
                        "</div>" 

                        id_num++
                    }
                    else{
                        text += ' ' + word
                    }
            }
            document.getElementById('output').innerHTML = text
        }

        const spans = document.getElementsByTagName("span")
        const as = document.getElementsByTagName("a")

        for (let span of spans) {
        span.addEventListener("click", span_pressed)
        }
        for (let a of as){
            a.addEventListener("click", a_pressed)
        }

        const span_pressed = e => {
        span_id = e.target.id
        }

        const a_pressed = d =>{
            a_id = d.target.id
            console.log(span_id)
            console.log(a_id)
            document.getElementById(span_id).innerHTML = document.getElementById(a_id).innerHTML
        }
        
        function dropdown() {
            document.getElementById("dropdown").classList.toggle("show")
        }

    </script>
</body>
</html>


